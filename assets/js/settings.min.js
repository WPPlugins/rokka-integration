jQuery(document).ready(function(e){function a(){var e=new Date;return"["+("0"+e.getDate()).slice(-2)+"."+("0"+(e.getMonth()+1)).slice(-2)+"."+e.getFullYear()+" "+("0"+(e.getHours()+1)).slice(-2)+":"+("0"+(e.getMinutes()+1)).slice(-2)+":"+("0"+(e.getSeconds()+1)).slice(-2)+"]"}e("#mass-upload-everything").click(function(s){function t(s){if(s.length>0){var n=s.shift();e.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"rokka_upload_image",image_id:n,nonce:rokkaSettings.nonce}}).done(function(){o.val(o.val()+a()+" "+rokkaSettings.labels.uploadSingleImageSuccess+" "+n+"\n")}).fail(function(e){o.val(o.val()+a()+" "+rokkaSettings.labels.uploadSingleImageFail+" "+n+" / Error: "+e.responseJSON.data+"\n"),c=!0}).always(function(){d+=1,l.progressbar("value",d*g),t(s)})}else c?(o.val(o.val()+a()+" "+rokkaSettings.labels.uploadImagesFail),i.html('<div class="notice notice-error"><p>'+rokkaSettings.labels.uploadImagesFail+"</p></div>")):(o.val(o.val()+a()+" "+rokkaSettings.labels.uploadImagesSuccess),i.html('<div class="notice notice-success"><p>'+rokkaSettings.labels.uploadImagesSuccess+"</p></div>"))}var l=e("#upload-progressbar"),n=e("#upload-progress-log-wrapper"),o=e("#upload-progress-log"),i=e("#upload-progress-info"),r=rokkaSettings.imagesToUpload,c=!1;i.html(""),o.val(""),l.hide(),n.hide();var g=100/r.length,d=0;r.length>0?(l.show(),l.progressbar({value:0}),n.show(),t(r)):i.html('<div class="notice notice-success"><p>'+rokkaSettings.labels.uploadImagesAlreadyUploaded+"</p></div>")}),e("#mass-delete-everything").click(function(s){function t(s){if(s.length>0){var n=s.shift();e.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"rokka_delete_image",image_id:n,nonce:rokkaSettings.nonce}}).done(function(){o.val(o.val()+a()+" "+rokkaSettings.labels.deleteSingleImageSuccess+" "+n+"\n")}).fail(function(e){o.val(o.val()+a()+" "+rokkaSettings.labels.deleteSingleImageFail+" "+n+" / Error: "+e.responseJSON.data+"\n"),c=!0}).always(function(){d+=1,l.progressbar("value",d*g),t(s)})}else c?(o.val(o.val()+a()+" "+rokkaSettings.labels.deleteImagesFail),i.html('<div class="notice notice-error"><p>'+rokkaSettings.labels.deleteImagesFail+"</p></div>")):(o.val(o.val()+a()+" "+rokkaSettings.labels.deleteImagesSuccess),i.html('<div class="notice notice-success"><p>'+rokkaSettings.labels.deleteImagesSuccess+"</p></div>"))}var l=e("#delete-progressbar"),n=e("#delete-progress-log-wrapper"),o=e("#delete-progress-log"),i=e("#delete-progress-info"),r=rokkaSettings.imagesToDelete,c=!1;if(!0===confirm(rokkaSettings.labels.deleteImagesConfirm)){i.html(""),o.val(""),l.hide(),n.hide();var g=100/r.length,d=0;r.length>0?(l.show(),l.progressbar({value:0}),n.show(),t(r)):i.html('<div class="notice notice-success"><p>'+rokkaSettings.labels.deleteImagesNoImage+"</p></div>")}}),e("#sync-rokka-stacks").click(function(a){e("#progress-info-stacks").html('<div class="notice notice-info"><p class="loading-indicator"><img src="'+rokkaSettings.loadingSpinnerUrl+'" alt="" width="16" height="16" /><span> '+rokkaSettings.labels.createStacksStart+"</span></p></div>"),e.ajax({type:"GET",url:ajaxurl,data:{action:"rokka_sync_stacks",nonce:rokkaSettings.nonce}}).done(function(){e("#progress-info-stacks").html('<div class="notice notice-success"><p>'+rokkaSettings.labels.syncStacksSuccess+"</p></div>")}).fail(function(a){e("#progress-info-stacks").html('<div class="notice notice-error"><p>'+rokkaSettings.labels.syncStacksFail+" "+a.responseJSON.data+"</p></div>")})}),e("#check-rokka-credentials").click(function(a){a.preventDefault(),e.ajax({type:"GET",url:ajaxurl,data:{action:"rokka_check_credentials",nonce:rokkaSettings.nonce}}).done(function(a){e("#rokka-credentials-status").html('<div class="notice notice-success"><p>'+a.data+"</p></div>")}).fail(function(a){e("#rokka-credentials-status").html('<div class="notice notice-error"><p>'+a.responseJSON.data+"</p></div>")})})});